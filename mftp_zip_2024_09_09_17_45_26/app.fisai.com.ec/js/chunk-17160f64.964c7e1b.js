(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-17160f64"],{"1cd0":function(t,e,a){"use strict";a("fe6f")},"70c6":function(t,e,a){"use strict";a.r(e);a("b0c0");var n=function(){var t=this,e=t._self._c;return e("b-container",{attrs:{fluid:""}},[e("b-row",[e("b-col",{attrs:{md:"12"}},[e("iq-card",{scopedSlots:t._u([{key:"headerTitle",fn:function(){return[e("h4",{staticClass:"card-title"},[t._v("Notas de Evolución")])]},proxy:!0},{key:"headerAction",fn:function(){return[e("b-button",{attrs:{variant:"primary"},on:{click:function(e){return t.showModalAdd(t.data)}}},[t._v(" Agregar ")])]},proxy:!0},{key:"body",fn:function(){return[t.history?e("DataTable",{attrs:{data:t.history,columns:t.columns,"fields-search":["diagnoses","weight","height","systolic_pressure","diastolic_pressure"]},scopedSlots:t._u([{key:"rows",fn:function(a){var n=a.row,s=a.rowIndex;return[e("tr",[e("th",{attrs:{scope:"row"}},[t._v(t._s(s+1))]),e("td",[t._v(" "+t._s(n.user.first_last_name)+" "+t._s(n.user.second_last_name)+", "+t._s(n.user.name)+" ")]),e("td",[e("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"collapse-".concat(s),expression:"`collapse-${rowIndex}`"}],attrs:{variant:"primary"}},[t._v("Ver notas de Evolución")]),e("b-collapse",{staticClass:"mt-2",attrs:{id:"collapse-".concat(s)}},[e("b-card",t._l(n.evolution,(function(a){return e("ul",{staticClass:"border px-2 m-0 py-2"},[e("li",[e("strong",[t._v("Fecha:")]),t._v(" "+t._s(a.date)+" - "),e("strong",[t._v("Hora:")]),t._v(" "+t._s(a.time)+" ")]),e("li",[e("ul",{staticClass:"p-0 m-0"},[e("li",[e("strong",[t._v("S:")]),t._v(" "+t._s(a.s))]),e("li",[e("strong",[t._v("O:")]),t._v(" "+t._s(a.o))]),e("li",[e("strong",[t._v("A:")]),t._v(" "+t._s(a.a))]),e("li",[e("strong",[t._v("P:")]),t._v(" "+t._s(a.p))])])])])})),0)],1)],1),e("td",[e("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"collapse-prescriptions-".concat(s),expression:"`collapse-prescriptions-${rowIndex}`"}],attrs:{variant:"primary"}},[t._v("Ver Prescripciones")]),e("b-collapse",{staticClass:"mt-2",attrs:{id:"collapse-prescriptions-".concat(s)}},[e("b-card",t._l(n.prescriptions,(function(a){return e("ul",{staticClass:"border p-2 m-0"},[e("li",[e("strong",[t._v("Farmacoterapia e indicaciones:")]),t._v(" "+t._s(a.farmacos)+", ")]),e("li",[e("strong",[t._v("Farmacos:")]),t._v(" "+t._s(a.indications)+" ")])])})),0)],1)],1),e("td",[t._v(" "+t._s(n.created_at)+" ")]),e("td",[e("b-button-group",["Paciente"!=t.role&&t.lastId===n.id?e("b-button",{directives:[{name:"user-can",rawName:"v-user-can",value:"leer pacientes",expression:"'leer pacientes'"},{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{variant:"warning",size:"sm",title:"Editar"},on:{click:function(e){return t.showModalEdit(n)}}},[e("i",{staticClass:"ri-ball-pen-fill m-0"})]):t._e(),e("b-button",{directives:[{name:"user-can",rawName:"v-user-can",value:"leer pacientes",expression:"'leer pacientes'"}],attrs:{variant:"secondary",size:"sm"},on:{click:function(e){return t.showModal(n)}}},[e("i",{staticClass:"ri-eye-fill m-0"})]),e("b-button",{directives:[{name:"user-can",rawName:"v-user-can",value:"leer pacientes",expression:"'leer pacientes'"}],attrs:{variant:"success",size:"sm"},on:{click:function(e){return t.downloadPdf(n)}}},[e("i",{staticClass:"ri-file-fill m-0"})])],1)],1)])]}}],null,!1,1733625410)}):t._e()]},proxy:!0}])})],1)],1),e("b-modal",{attrs:{id:"modal-data",title:"Historial Clínico","hide-footer":""}},[e("ul",[e("li",[e("b",[t._v("Institucion del Sistema:")]),t._v(" "+t._s(t.data.institucion))])])]),e("b-modal",{attrs:{id:"modal-edit",title:"Notas de Evolución","hide-footer":"",size:"lg","no-close-on-backdrop":""}},[e("ValidationObserver",{ref:"form",scopedSlots:t._u([{key:"default",fn:function(a){var n=a.handleSubmit;return[e("b-form",{on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),n(t.onSubmitEvolutionNote)}}},[e("b-row",[e("div",{staticClass:"col-md-12"},[e("p",[t._v("EVOLUCIÓN")])]),e("table",{staticClass:"table"},[e("thead",[e("tr",[e("th",[t._v("Fecha:")]),e("th",[t._v("Hora:")]),e("th",[t._v("Notas de Evolución (SOAP):")]),e("th",[t._v("-")])])]),e("tbody",[t._l(t.evolutions,(function(a){return e("tr",{key:a.date},[e("td",[t._v(" "+t._s(a.date)+" ")]),e("td",[t._v(" "+t._s(a.time)+" ")]),e("td",[e("ul",[e("li",[t._v("S: "+t._s(a.s))]),e("li",[t._v("O: "+t._s(a.o))]),e("li",[t._v("A: "+t._s(a.a))]),e("li",[t._v("P: "+t._s(a.p))])])]),e("td",[e("button",{staticClass:"btn btn-warning",on:{click:function(){return t.handleDeleteEvolution(a.notes)}}},[t._v(" X ")])])])})),e("tr",[e("td",[e("b-form-input",{attrs:{type:"date"},model:{value:t.evolution.date,callback:function(e){t.$set(t.evolution,"date",e)},expression:"evolution.date"}})],1),e("td",[e("b-form-input",{attrs:{type:"time"},model:{value:t.evolution.time,callback:function(e){t.$set(t.evolution,"time",e)},expression:"evolution.time"}})],1),e("td",[e("div",{staticClass:"d-flex flex-column gap-3"},[e("label",{staticClass:"d-flex align-items-center"},[t._v(" S: "),e("b-form-input",{staticClass:"mb-2",model:{value:t.evolution.s,callback:function(e){t.$set(t.evolution,"s",e)},expression:"evolution.s"}})],1),e("label",{staticClass:"d-flex align-items-center"},[t._v(" O: "),e("b-form-input",{staticClass:"mb-2",model:{value:t.evolution.o,callback:function(e){t.$set(t.evolution,"o",e)},expression:"evolution.o"}})],1),e("label",{staticClass:"d-flex align-items-center"},[t._v(" A: "),e("b-form-input",{staticClass:"mb-2",model:{value:t.evolution.a,callback:function(e){t.$set(t.evolution,"a",e)},expression:"evolution.a"}})],1),e("label",{staticClass:"d-flex align-items-center"},[t._v(" P: "),e("b-form-input",{staticClass:"mb-2",model:{value:t.evolution.p,callback:function(e){t.$set(t.evolution,"p",e)},expression:"evolution.p"}})],1)])]),e("td",[e("button",{staticClass:"btn btn-primary",on:{click:t.handleAddEvolution}},[t._v(" Agregar ")])])])],2)]),e("div",{staticClass:"col-md-12"},[e("p",[t._v("PRESCRIPCIONES")])]),e("table",{staticClass:"table"},[e("thead",[e("tr",[e("th",[t._v("Farmacoterapia e indicaciones:")]),e("th",[t._v("Farmacos:")]),e("th",[t._v("-")])])]),e("tbody",[t._l(t.prescriptions,(function(a){return e("tr",{key:a.date},[e("td",[t._v(" "+t._s(a.indications)+" ")]),e("td",[t._v(" "+t._s(a.farmacos)+" ")]),e("td",[e("button",{staticClass:"btn btn-warning",on:{click:function(){return t.handleDeletePrescription(a.indications)}}},[t._v(" X ")])])])})),e("tr",[e("td",[e("b-form-textarea",{model:{value:t.prescription.indications,callback:function(e){t.$set(t.prescription,"indications",e)},expression:"prescription.indications"}})],1),e("td",[e("b-form-textarea",{model:{value:t.prescription.farmacos,callback:function(e){t.$set(t.prescription,"farmacos",e)},expression:"prescription.farmacos"}})],1),e("td",[e("button",{staticClass:"btn btn-primary",on:{click:t.handleAddPrescription}},[t._v(" Agregar ")])])])],2)]),e("b-form-group",{staticClass:"col-md-12",attrs:{"label-for":"Personal de Salud",label:"Personal de Salud:"}},[e("b-form-select",{attrs:{plain:"",options:t.doctors,id:"salud"},model:{value:t.data.medicalID,callback:function(e){t.$set(t.data,"medicalID",e)},expression:"data.medicalID"}})],1)],1),e("b-button",{staticClass:"mr-2",attrs:{type:"submit",variant:"primary"}},[t._v(" Guardar ")]),e("b-button",{staticClass:"iq-bg-danger",attrs:{type:"reset",variant:"none"}},[t._v(" Cancelar ")])],1)]}}])})],1)],1)},s=[],i=a("c7eb"),o=a("1da1"),r=a("5530"),c=a("2909"),l=a("3835"),d=a("ade3"),u=(a("99af"),a("b64b"),a("4de4"),a("d3b7"),a("7db0"),a("a4d3"),a("e01a"),a("159b"),a("a630"),a("3ca3"),a("14d9"),a("d81d"),a("ddb0"),a("2b3d"),a("9861"),a("88a7"),a("271a"),a("5494"),a("442f")),p=a("bcae"),v=a("7424"),b=a("1fdb"),f=a("3d20"),m=a.n(f),h=a("95e8"),_={components:{DataTable:b["a"]},data:function(){var t;return t={role:null,data:{},type:"add",history:[],columns:[{name:"Paciente",field:"name",sort:""},{name:"Notas de Evolucion",field:"notes",sort:""},{name:"Prescripciones",field:"prescriptions",sort:""},{name:"Fecha",field:"created_at",sort:""},{name:"Acciones",field:"actions",sort:""}],lastId:null},Object(d["a"])(t,"type","add"),Object(d["a"])(t,"result",{}),Object(d["a"])(t,"results",[]),Object(d["a"])(t,"diagnosis",{}),Object(d["a"])(t,"diagnosses",[]),Object(d["a"])(t,"images",[]),Object(d["a"])(t,"doctors",[]),Object(d["a"])(t,"fecha",""),Object(d["a"])(t,"diagnosis_description",""),Object(d["a"])(t,"diagnosis_code",""),Object(d["a"])(t,"codes",[]),Object(d["a"])(t,"evolution",{date:" ",time:" ",notes:" "}),Object(d["a"])(t,"evolutions",[]),Object(d["a"])(t,"prescription",{indications:" ",farmacos:" "}),Object(d["a"])(t,"prescriptions",[]),t},filters:{formatDate:function(t){if(!t)return"";var e=t.split("-"),a=Object(l["a"])(e,3),n=a[0],s=a[1],i=a[2];return"".concat(i,"/").concat(s,"/").concat(n)}},mounted:function(){p["a"].index(),this.getData(),this.getDoctors();var t=JSON.parse(localStorage.getItem("user"));this.role=t.role,this.codes=h},methods:{handleAddEvolution:function(t){t.preventDefault();var e=this.evolution.date.split("-");this.evolution.date="".concat(e[2],"/").concat(e[1],"/").concat(e[0]),this.evolutions=[].concat(Object(c["a"])(this.evolutions),[this.evolution]),this.evolution={}},handleAddPrescription:function(t){t.preventDefault(),this.prescriptions=[].concat(Object(c["a"])(this.prescriptions),[this.prescription]),this.prescription={}},handleDeleteEvolution:function(t){this.evolutions=this.evolutions.filter((function(e){return e.notes!=t}))},handleDeletePrescription:function(t){this.prescriptions=this.prescriptions.filter((function(e){return e.indications!=t}))},handleChangeCie:function(t){var e=this.codes.find((function(e){return e.code==t.toUpperCase()?e:""}));void 0!=e&&(this.diagnosis_description=e.description,this.diagnosis_code=e.code)},formatNumber:function(t){return parseInt(t)},previewImages:function(t){var e=this,a=t.target.files;this.result.images=a,a&&a.length>0&&(this.images=[],Array.from(a).forEach((function(t){var a=new FileReader;a.onload=function(t){e.images.push(t.target.result)},a.readAsDataURL(t)})))},handleAddResult:function(t){t.preventDefault(),console.log(this.result.date);var e=this.result.date.split("-");this.result.date="".concat(e[2],"/").concat(e[1],"/").concat(e[0]),this.results=[].concat(Object(c["a"])(this.results),[this.result]),this.images=[],this.result={}},handleDeleteResult:function(t){this.results=this.results.filter((function(e){return e.result!=t}))},handleAddDiagnosis:function(t){t.preventDefault();var e=Object(r["a"])(Object(r["a"])({},this.diagnosis),{},{cie:this.diagnosis_code,description:this.diagnosis_description});this.diagnosses=[].concat(Object(c["a"])(this.diagnosses),[e]),this.diagnosis={}},handleDeleteDiagnosis:function(t){this.diagnosses=this.diagnosses.filter((function(e){return e.cie!=t}))},getDoctors:function(){var t=this;return Object(o["a"])(Object(i["a"])().mark((function e(){var a,n;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v["a"].get("/doctors");case 3:a=e.sent,n=a.data,t.doctors=Object(c["a"])(n.data.map((function(t){return{value:t.id,text:t.name}}))),console.log(t.doctors),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()},getData:function(){var t=this;return Object(o["a"])(Object(i["a"])().mark((function e(){var a,n;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v["a"].get("/evolution-notes?patient_id=".concat(t.$route.params.id));case 3:a=e.sent,n=a.data,t.history=n.data,t.lastId=t.history?t.history[0].id:null,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),u["a"].fire({icon:"error",title:"Error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()},showModal:function(t){this.data=t,this.$bvModal.show("modal-data")},showModalAdd:function(t){this.prescriptions=[],this.evolutions=[],this.data={},this.type="add",this.$bvModal.show("modal-edit"),this.data=t},showModalEdit:function(t){var e,a;this.prescriptions=null!==(e=Object(c["a"])(t.prescriptions))&&void 0!==e?e:[],this.evolutions=null!==(a=Object(c["a"])(t.evolution))&&void 0!==a?a:[],this.type="edit",this.$bvModal.show("modal-edit")},destroy:function(t){var e=this;m.a.fire({icon:"warning",title:"Seguro de eliminar",showDenyButton:!1,showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"Cancelar"}).then((function(a){a.isConfirmed&&v["a"].delete("/medical-history/".concat(t)).then((function(t){200===t.status&&(u["a"].fire({icon:"success",title:"Eliminado correctamente"}),e.getData())})).catch((function(t){u["a"].fire({icon:"error",title:t.message})}))}))},onSubmitEvolutionNote:function(){var t=this;return Object(o["a"])(Object(i["a"])().mark((function e(){var a;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a="/patients/".concat(t.$route.params.id,"/evolution"),e.prev=1,t.data=Object(r["a"])(Object(r["a"])({},t.data),{},{evolution:t.evolutions,prescriptions:t.prescriptions}),console.log(t.data),"add"!==t.type){e.next=10;break}return e.next=7,v["a"].post(a,t.data);case 7:e.sent,e.next=13;break;case 10:return e.next=12,v["a"].put(a,t.data);case 12:e.sent;case 13:return e.next=15,t.getData();case 15:t.$bvModal.hide("modal-edit"),e.next=21;break;case 18:e.prev=18,e.t0=e["catch"](1),u["a"].fire({icon:"error",title:"Error"});case 21:case"end":return e.stop()}}),e,null,[[1,18]])})))()},onSubmitExtraData:function(){var t=this;return Object(o["a"])(Object(i["a"])().mark((function e(){var a,n,s;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a="/patients/".concat(t.$route.params.id,"/extra"),n=new FormData,t.results.forEach((function(t,e){n.append("results[".concat(e,"][name]"),t.name),n.append("results[".concat(e,"][date]"),t.date),n.append("results[".concat(e,"][result]"),t.result);for(var a=0;a<t.images.length;a++)n.append("results[".concat(e,"][images][]"),t.images[a])})),e.prev=3,t.data=Object(r["a"])(Object(r["a"])({},t.data),{},{exam_results:[],diagnoses:t.diagnosses}),"add"!==t.type){e.next=11;break}return e.next=8,v["a"].post(a,t.data);case 8:s=e.sent,e.next=14;break;case 11:return e.next=13,v["a"].put(a,t.data);case 13:s=e.sent;case 14:if(!s){e.next=17;break}return e.next=17,v["a"].post("/patients/".concat(t.$route.params.id,"/history/images"),n);case 17:return e.next=19,t.getData();case 19:t.$bvModal.hide("modal-edit"),e.next=25;break;case 22:e.prev=22,e.t0=e["catch"](3),u["a"].fire({icon:"error",title:"Error"});case 25:case"end":return e.stop()}}),e,null,[[3,22]])})))()},downloadPdf:function(t){var e=this;return Object(o["a"])(Object(i["a"])().mark((function a(){var n,s,o,r;return Object(i["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n="/patients/".concat(e.$route.params.id,"/evolution-note/pdf"),a.prev=1,a.next=4,v["a"].post(n,{row:t},{responseType:"blob"});case 4:s=a.sent,o=window.URL.createObjectURL(new Blob([s.data])),r=document.createElement("a"),r.href=o,r.setAttribute("download","Evolution-notes.pdf"),document.body.appendChild(r),r.click(),document.body.removeChild(r),u["a"].fire({icon:"success",title:"PDF generado"}),a.next=18;break;case 15:a.prev=15,a.t0=a["catch"](1),u["a"].fire({icon:"error",title:"Error"});case 18:case"end":return a.stop()}}),a,null,[[1,15]])})))()}}},g=_,x=(a("1cd0"),a("2877")),w=Object(x["a"])(g,n,s,!1,null,"47b73b74",null);e["default"]=w.exports},fe6f:function(t,e,a){}}]);
//# sourceMappingURL=chunk-17160f64.964c7e1b.js.map